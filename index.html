<!DOCTYPE html>
<html style="height: 100%">
<head>
<meta charset="UTF-8">
<title>electron-study</title>
<link href="./style.css" rel="stylesheet"/>
<script>
  const isDev = require('electron-is-dev');
  window.jQuery = window.$ = require('jquery');

  function onload() {
    const webview = document.querySelector("webview");
    webview.addEventListener("dom-ready", function() {
      if (isDev) {
        webview.openDevTools();
      }
    });

    webview.addEventListener("will-navigate", function(data) {
      $("#browser_url").val(data.url);
    });

    webview.addEventListener("did-navigate", function(data) {
      $("#browser_url").val(data.url);
    });
  }

  function menuItemClicked(sender) {
    const menu_id = $(sender).attr("data-menu-id");

    $("#menu_container").children().each(function() {
      const menu = $(this);
      if (menu.attr("data-menu-id") == menu_id) {
        menu.addClass("ThemeContainerActive")
        menu.removeClass("ThemeContainerBorderR");
      } else {
        menu.removeClass("ThemeContainerActive");
        menu.addClass("ThemeContainerBorderR");
      }
    });

    $("#tool_container").children().each(function() {
      const tool = $(this);
      if (tool.attr("id") == menu_id) {
        tool.addClass("ToolPanelActive");
      } else {
        tool.removeClass("ToolPanelActive");
      }
    });
  }

  function browserBackClicked(sender) {
    document.querySelector("webview").goBack();
  }

  function browserReloadClicked(sender) {
    document.querySelector("webview").reload();
  }
</script>
</head>
<body style="margin: 0; padding: 0; min-width: 100%; min-height: 100%" onload="onload()">
  <div class="ThemeContainer" style="display: flex; flex-direction: column; min-width: 1200px; width: 100vw; height: 100vh;">
    <div style="flex: 0 0 720px;">
      <webview
        id="wv"
        src="http://www.dmm.com/netgame/social/-/gadgets/=/app_id=854854/"
        style="width: 1200px; height: 720px; margin: auto;"
        nodeintegration
        partition="persist:electron-study"
        preload="./preload.js">
      </webview>
    </div>
    <div class="ThemeContainer ThemeContainerBorderT" style="flex: 1 1 auto; min-height: 200px; display: flex">
      <div id="menu_container" class="ThemeContainer" style="flex: 0 0 100px; display: flex; flex-direction: column;">
        <div class="MenuItem ThemeContainer ThemeContainerActive ThemeContainerBorderB" onclick="menuItemClicked(this)" data-menu-id="deck_tool">
          編成
        </div>
        <div class="MenuItem ThemeContainer ThemeContainerBorderB ThemeContainerBorderR" onclick="menuItemClicked(this)" data-menu-id="browser_tool">
          ブラウザ
        </div>
        <div role="spacer" class="ThemeContainerBorderR" style="flex: 1 1 auto;"></div>
      </div>
      <div id="tool_container" class="ThemeContainer" style="flex: 1 1 auto; display: flex;">
        <div id="deck_tool" class="ThemeContainerActive ToolPanel ToolPanelActive">
        </div>
        <div id="browser_tool" class="ThemeContainerActive ToolPanel">
          <div style="margin-left: 5px; display: flex;">
            <input id="browser_url" type="text" class="ThemeContainerActive ThemeContainerBorder" readonly="readonly" style="flex: 1 0 auto; margin: 5px 5px 5px 5px; padding: 0px 5px 0px 5px; line-height: 30px; cursor: text; display: flex;"/>
            <div class="ThemeCircleButton" style="flex: 0 0 30px; height: 30px; width: 30px; margin: 5px; line-height: 30px;" onclick="browserBackClicked(this)">
              ⬅
            </div>
            <div class="ThemeCircleButton" style="flex: 0 0 30px; height: 30px; height: 30px; margin: 5px 10px 5px 5px; line-height: 30px;" onclick="browserReloadClicked(this)">
              ↻
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
